<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대검찰청 식단표</title>
    <style>
        :root { --primary: #3e28b6; --bg: #f8f9fa; }
        body { font-family: 'Pretendard', -apple-system, sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        h1 { text-align: center; color: var(--primary); margin-bottom: 10px; letter-spacing: -1px; }
        .week-info { text-align: center; color: #666; margin-bottom: 30px; font-size: 1.0rem; font-weight: 500; }
        
        /* PC */
        table { width: 100%; border-collapse: collapse; table-layout: fixed; border-top: 2px solid var(--primary); }
        th { background: #fcfcfc; color: #333; padding: 15px 5px; font-size: 0.9rem; border-bottom: 1px solid #ddd; }
        th span { display: block; font-size: 0.8rem; font-weight: normal; margin-top: 4px; color: var(--primary); }
        td { border-bottom: 1px solid #eee; padding: 20px 10px; text-align: center; vertical-align: top; font-size: 0.9rem; line-height: 1.6; word-break: keep-all; }
        .type-label { font-weight: bold; color: var(--primary); background: #f0f7ff; width: 80px; vertical-align: middle; border-right: 1px solid #e1ecf7; }
        
        /* 메뉴 텍스트 스타일 */
        .main-menu { display: block; font-size: 1.0rem; font-weight: 600; color: #000; margin-bottom: 5px; }
        .sub-menu { color: #666; font-size: 0.85rem; }

        /* 모바일 */
        @media screen and (max-width: 700px) {
            .container { padding: 15px; }
            table, thead, tbody, th, td, tr { display: block; } /* 테이블 형식을 해제 */
            thead { display: none; }
            
            tr { margin-bottom: 30px; border: 1px solid #e1ecf7; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
            
            .type-label { 
                width: 100% !important; 
                padding: 10px; 
                background: var(--primary); 
                color: white; 
                border-right: none;
                font-size: 1.1rem;
            }
            
            td:not(.type-label) {
                text-align: left;
                padding: 15px 20px;
                border-bottom: 1px dashed #eee;
            }
            
            /* 모바일에서 날짜 표시 */
            td:not(.type-label)::before {
                content: attr(data-day);
                display: inline-block;
                color: var(--primary);
                font-weight: bold;
                font-size: 0.8rem;
                background: #f0f7ff;
                padding: 2px 8px;
                border-radius: 4px;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>대검찰청 식단표</h1>
        <div id="current-week" class="week-info"></div>
        <table>
            <thead>
                <tr>
                    <th>구분</th>
                    <th id="day0">월</th><th id="day1">화</th><th id="day2">수</th><th id="day3">목</th><th id="day4">금</th>
                </tr>
            </thead>
            <tbody id="menu-body"></tbody>
        </table>
    </div>

    <script>
        const dayTexts = []; // 모바일 요일 배열

        function setDates() {
            const now = new Date();
            const day = now.getDay();
            const diffToMonday = now.getDate() - day + (day === 0 ? -6 : 1);
            const monday = new Date(now.setDate(diffToMonday));
            
            const weekInfo = document.getElementById('current-week');
            const friday = new Date(monday);
            friday.setDate(monday.getDate() + 4);
            weekInfo.innerText = `${monday.getFullYear()}년 ${monday.getMonth()+1}월`;

            for (let i = 0; i < 5; i++) {
                const date = new Date(monday);
                date.setDate(monday.getDate() + i);
                const dateStr = `${date.getMonth()+1}/${date.getDate()}`;
                const dayName = ['월','화','수','목','금'][i];
                
                // 모바일 날짜 텍스트 저장
                dayTexts.push(`${dayName} (${dateStr})`);
                
                document.getElementById(`day${i}`).innerHTML = 
                    `${dayName}<span>${dateStr}</span>`;
            }
        }

        fetch('menu.json')
            .then(res => res.json())
            .then(data => {
                const tbody = document.getElementById('menu-body');
                setDates(); // 날짜 먼저 계산

                ['한식', '일품3층'].forEach(type => {
                    if(!data[type]) return; 
                    
                    let row = `<tr><td class="type-label">${type}</td>`;
                    data[type].forEach((item, index) => {
                        const parts = item.split(',');
                        const mainMenu = parts[0].trim();
                        const subMenus = parts.slice(1).map(s => s.trim()).join('<br>');
                        
                        // 모바일 표시
                        row += `<td data-day="${dayTexts[index]}">
                                    <span class="main-menu">${mainMenu}</span>
                                    <span class="sub-menu">${subMenus}</span>
                                </td>`;
                    });
                    row += `</tr>`;
                    tbody.innerHTML += row;
                });
            });
    </script>
</body>
</html>
